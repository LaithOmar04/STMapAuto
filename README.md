## **Ca2+ Imaging Analysis:**

Intracellular Ca2+ signals occur in nearly all cells, and mediate a myriad of functions such as cell proliferation, secretion, fertilization, and muscle contraction. To investigate these phenomena, Ca2+ signals are commonly recorded by using either traditional Ca2+ dyes or genetically encoded Ca2+ indicators. However, intracellular Ca2+ signals encode specific responses via complex spatial and temporal patterns including localized oscillations and cell-wide waves, which can be arduous to decipher manually. Therefore, we aim to dramatically enhance current methods of Ca2+ event detection and analysis. Thus far, we have developed an automated algorithmic solution to the analysis of Ca2+ signal dynamics and have incorporated a machine learning approach into Ca2+ Spatio-Temporal Map analysis.

We developed a Spatio-Temporal Map analysis plugin (STMapAuto) that is fully compatible with Fiji/Image J. This plugin allows for automatic extraction of key Ca2+ event information such as: frequency, propagation velocity, intensity, area, and spatial spread. The developed analysis methods will dramatically reduce opportunities for user error and will provide a fast, standardized and accurate analysis to allow for high throughput analysis of multiple datasets.

## **Supplemental Information**
Processes involved in automated analysis of ICC Ca2+ STMaps in ImageJ.
1. Upon opening of the .tif image to be analyzed .tif image in imageJ, the plugin prompts ImageJ to open a Properties window, where the user will be able to calibrate the image. The calibration will allow for both spatial and temporal calibration.
2. The plugin creates and initializes a RoiManager object. This object exists in the plugin and in ImageJ, and is where individual measurements of Ca2+ events take place.
3. The plugin creates and initializes an ImagePlus object to the currently open image. This is loaded directly into the plugin.
4. The plugin creates and initializes a WekaSegmentation object with the previously created ImagePlus object. 
5. Once the WekaSegmentation is initialized, the plugin creates and initializes an OpenDialog object, which prompts the user to pick a classifier of their choice. 
6. The plugin loads the classifier into the WekaSegmentation object, and it is applied. This will generate a classified image.
7. An ImagePlus object is created and initialized to the classified image generated by the WekaSegmentation object. The image will be then displayed by ImageJ.
8. The image will then be a black image. To fix this, the plugin applies the Enhance Contrast function in ImageJ. The image itself remains unchanged, this is for visibility purposes.
9. The plugin then sends another function to ImageJ, applying the Intermodes threshold. At this point, the image has been segmented.
10. Following this, the plugin will then send a command to ImageJ to measure Area, Bounding Rectangle, Fit Ellipse and Mean Gray Value.
11. The plugin will then send a following command to ImageJ, setting Analyze Particles menu to summarize the different objects and to add the objects to the open ROIManager. The plugin will also send command to close the result image.
12. With the original image, the ROIManager object will apply the mask created by the thresholding and particle analysis, and then measure. This will generate the results.
13. The plugin will send a command to save the results to an excel spreadsheet, and save it to the classifier folder.



## **STMapAuto plugin manual:**

First time use:
After downloading the plugin into Fiji 
Create 2 folders on your computer (i.e. Input and output folders)
Download classifiers to your PC  (link)

Now the software is ready to be used: 

Move STMaps to be analyzed into “input folder” 
Open STMapAuto 
Insert image calibration parameters
Select input folder 
Select output folder 
Select your optimized classifier 
All segmented images and excel file are located in the output folder 


For optimization of new classifiers and training of new set of STMaps 

Open plugin 
Train your data set 
Optimize new classifier http://imagej.net/Trainable_Weka_Segmentation
Save classifier to library 

## **Explanation of results:**
The Excel file will have 10 columns. The information in each column is as follows.
* Col. A: The number corresponding to each ROI.
* Col. B: The area of the corresponding ROI.
* Col. C: The mean gray value of the corresponding ROI.
* Col. D: The x coordinate of the top left corner of the bounding rectangle of the corresponding ROI.
* Col. E: The y coordinate of the top left corner of the bounding rectangle of the corresponding ROI.
* Col. F: The width of the bounding rectangle of the corresponding ROI.
* Col. G: The height of the bounding rectangle of the corresponding ROI.
* Col. H: The major axis of the bounding ellipse of the corresponding ROI.
* Col. I: The minor axis of the bounding ellipse of the corresponding ROI.
* Col. J: The angle of the bounding ellipse of the corresponding ROI.

## **Citation for Trainable Weka Segmentation:**
* Arganda-Carreras, I., Kaynig, V., Rueden, C., Eliceiri, K. W., Schindelin, J., Cardona, A., & Seung, H. S. (2017). [Trainable Weka Segmentation: a machine learning tool for microscopy pixel classification](https://academic.oup.com/bioinformatics/article-abstract/doi/10.1093/bioinformatics/btx180/3092362/Trainable-Weka-Segmentation-a-machine-learning). Bioinformatics (Oxford Univ Press) 33 (15), [doi:10.1093/bioinformatics/btx180](http://dx.doi.org/10.1093%2Fbioinformatics%2Fbtx180) ([on Google Scholar](http://scholar.google.com/scholar?cluster=12995971888361615836)).

## **License:**
The code is released under the MIT License, you can read the license file included in the repository for details.

